# Иерархическая таблица

SPA-приложение на React для отображения иерархических данных с возможностью фильтрации и сортировки в виде таблицы.

## Особенности

- **Иерархическая структура** - древовидное представление данных с возможностью раскрытия/сворачивания строк
- **Фильтрация** - фильтрация по статусу (активные/неактивные)
- **Сортировка** - сортировка по балансу и email в обе стороны
- **Пагинация** - разбиение корневых элементов на страницы по 10 элементов с удобной навигацией
- **Адаптивный дизайн** - корректное отображение на различных устройствах
- **Современный UI** - чистый и интуитивный интерфейс
- **TypeScript** - типизация всего кода
- **Module SCSS** - изолированные стили для каждого компонента

## Технологии

- **React 19.2** - библиотека для построения пользовательского интерфейса
- **TypeScript 5.9** - типизированный JavaScript
- **Vite 7.2** - сборщик и dev-сервер
- **SCSS Modules** - модульные стили
- **Lucide React** - иконки (chevron, arrows)

## Установка и запуск

### Требования

- Node.js >= 16
- Yarn >= 1.22

### Команды

```bash
# Установка зависимостей
yarn install
# или
npm install

# Запуск dev-сервера
yarn dev
# или
npm run dev

# Сборка для production
yarn build
# или
npm run build

# Предварительный просмотр production-сборки
yarn preview
# или
npm run preview

# Линтинг кода
yarn lint
# или
npm run lint
```

После запуска `yarn dev` приложение будет доступно по адресу: <http://localhost:5173/>

## Структура проекта

```bash
src/
├── api/
│   └── mockApi.ts          # Mock API адаптер для данных
├── components/
│   ├── Header/             # Header с переключением темы
│   │   ├── Header.tsx
│   │   └── Header.module.scss
│   ├── Table/              # Главный компонент таблицы с логикой
│   │   ├── Table.tsx
│   │   └── Table.module.scss
│   ├── FilterDropdown/     # Dropdown для фильтрации
│   │   ├── FilterDropdown.tsx
│   │   └── FilterDropdown.module.scss
│   ├── TableHeader/        # Заголовок таблицы с сортировкой
│   │   ├── TableHeader.tsx
│   │   └── TableHeader.module.scss
│   ├── TableRow/           # Строка таблицы
│   │   ├── TableRow.tsx
│   │   └── TableRow.module.scss
│   └── Pagination/         # Компонент пагинации
│       ├── Pagination.tsx
│       └── Pagination.module.scss
├── types/
│   └── index.ts            # TypeScript типы и интерфейсы
├── hooks/
│   └── useTheme.ts         # Хук для темы приложения
├── utils/
│   └── treeUtils.ts        # Утилиты для работы с деревом и пагинацией
├── App.tsx                 # Главный компонент приложения
├── App.module.scss         # Стили главного компонента
├── index.css               # Глобальные стили и CSS-переменные
└── main.tsx                # Точка входа приложения
```

## Основные компоненты

### App.tsx

Главный компонент приложения, который:

- Загружает данные из Mock API
- Отображает экран загрузки и состояние ошибки
- Передаёт данные в компонент Table для дальнейшей обработки
- Использование хука useTheme

### Header

Header компонент приложения, позволяет переключать тему приложения (light/dark).

### Table

Главный компонент управления таблицей, отвечает за:

- Управление состоянием фильтров, сортировки, раскрытых строк и текущей страницы
- Фильтрацию данных по статусу (активные/неактивные)
- Сортировку по email и балансу
- Пагинацию корневых элементов
- Координацию работы дочерних компонентов (FilterPanel, TableHeader, TableRow, Pagination)

### FilterDropdown

Dropdown с фильтрами:

- **Все** - отображение всех элементов
- **Активные** - фильтр по isActive = true
- **Неактивные** - фильтр по isActive = false

### TableHeader

Заголовок таблицы с интерактивными колонками для сортировки:

- **Email** - сортируемая колонка с указанием направления (↑/↓)
- **Баланс** - сортируемая колонка с указанием направления (↑/↓)

### TableRow

Строка таблицы с:

- Отступом в зависимости от уровня вложенности (иерархия)
- Кнопкой раскрытия/сворачивания для элементов с дочерними узлами
- Цветовым индикатором статуса (зелёный для активных, серый для неактивных)
- Отображением информации: имя, email, баланс

### Pagination

Компонент пагинации для навигации по страницам:

- Кнопки "Предыдущая" и "Следующая"
- Номера страниц с выделением активной
- Отображение диапазона элементов (например, "1-10 из 50")
- Адаптивный дизайн, скрывает номера страниц на мобильных устройствах при необходимости

### Loading и Empty States

- **Loading** - отображение спиннера при загрузке данных
- **Empty State** - сообщение с иконкой при отсутствии данных или при пустом результате фильтрации

## Утилиты (treeUtils.ts)

- `buildTree()` - построение дерева из плоского массива с корректной обработкой орфанов (элементы без родителя становятся корневыми)
- `filterItems()` - фильтрация узлов дерева по статусу с сохранением иерархии (родитель показывается если показан хотя бы один потомок)
- `sortTree()` - рекурсивная сортировка узлов по полям email и balance в обе стороны
- `flattenTree()` - преобразование иерархического дерева в плоский список для отображения с учётом раскрытых узлов
- `paginate()` - разбиение массива на страницы для пагинации корневых элементов
- `parseBalance()` - парсинг строки баланса в число для корректной сортировки
- `hasChildren()` - проверка наличия дочерних элементов у узла

## Особенности реализации

### Построение иерархии

Приложение корректно обрабатывает неупорядоченные данные и строит древовидную структуру на основе полей `id` и `parentId`. Элементы без родителя (orphans) автоматически становятся корневыми элементами дерева.

### Фильтрация

Фильтрация работает рекурсивно - родительские элементы показываются, если хотя бы один из их потомков соответствует фильтру. Это обеспечивает корректный контекст для иерархических данных.

### Сортировка

Сортировка применяется рекурсивно ко всем уровням дерева, сохраняя иерархическую структуру. Работает по полям email (буквенная сортировка) и balance (числовая).

### Пагинация

Пагинация применяется только к **корневым элементам** дерева. Дочерние элементы развёрнутого узла показываются целиком без разбиения на страницы, что сохраняет целостность иерархии.

### Производительность

Использование `useMemo` и `useCallback` для оптимизации повторных вычислений и предотвращения лишних ре-рендеров. Set используется для O(1) быстрого поиска раскрытых узлов вместо массива.

## Дизайн

- Современная цветовая схема с градиентным фоном
- Четкая типографика
- Интерактивные элементы с плавными переходами
- Hover-эффекты для улучшения UX
- CSS-переменные для единообразия стилей
- Темная и светлая темы

## Требования к заданию

- ✅ SPA на React 19.2+ (совместимо с React 18+)
- ✅ Возможность раскрытия строк с дочерними элементами
- ✅ Фильтрация по isActive (Все, Активные, Неактивные)
- ✅ Сортировка по balance и email в обе стороны
- ✅ Корректная обработка неупорядоченных данных и орфанов
- ✅ Без использования UI-китов
- ✅ Работа в актуальной версии Chrome и современных браузерах

## Обработка ошибок

Приложение включает обработку ошибок при загрузке данных:

- **Try-Catch блок** в App.tsx для перехвата ошибок при fetchTableData()
- **Error State** - отображение сообщения об ошибке пользователю
- **Console logging** для отладки

## Разработка

Проект использует:

- ESLint для линтинга
- TypeScript strict mode для максимальной типобезопасности
- SCSS modules для изоляции стилей
